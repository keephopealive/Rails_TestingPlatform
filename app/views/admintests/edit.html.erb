	<style type="text/css">
    form.delete-answer{
        display: inline-block;
    }
    .added-answer{
        display: inline-block;
    }
    </style>
    <div class="row"> <!-- SETION: TEST DETAILS ROW -->
	    <div class="col-xs-12 formatted-div">
            <div class="row">
                <h3>Update Test Information:</h3>
                <div class="col-xs-5 padding5">
                    <div class="col-xs-4">
                        <label>Test Name:</label><br>
                        <label>Test URL:</label>
                    </div>
                    <div class="col-xs-8 font-black">
                        <input class="wide100" value="<%= @currentTest.name %>"><br>
                        <input class="wide100" value="url/here/">
                    </div>
                </div>
                <div class="col-xs-4 padding5">
                    <div class="col-xs-4">
                        <label>Test ID:</label>
                    </div>
                    <div class="col-xs-8">
                        <input class="font-black wide100" value="<%= @currentTest.id %>" readonly>
                    </div>
                </div>
                <div class="col-xs-3 padding5">
                    <button class="btn btn-primary">SAVE</button>
                    <button class="btn btn-danger">Delete</button>
                </div>
            </div>
		</div>
	</div> <!-- END SETION: TEST DETAILS ROW -->
    


    <ol class="sortable2" class="ol-questions" toleranceElement=" > ol"> <!-- QUESTIONS SORT -->       
    <% @currentTest.questions.each do |question| %> 
        <li class='ui-state-default'>
            <div class='row'>
                <div class='col-xs-12 questions-div'>
                    <div class='row'>
                        <div class='col-xs-12'>
                            <div class='question'>
<!-- SAVE QUESTION -->
<form method='post' action='/saveQuestion' class='questions'>
    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
    <input type='hidden' name='test_id' value='<%= @currentTest.id %>'>
    <input type='hidden' name='question_id' value='<%= question.id %>'>
    <textarea name='question'><%= question.question %></textarea>
</form>
                            </div>
                        </div>
                    </div>
                    <div class='row'>
                        <div class='col-xs-6'>
<div class='answers'>
    <h4>Click the circle to identify correct answer.</h4>
    <ol class='ol-questions-id'>
        <% question.answers.each do |answer| %>
             <li class='ui-state-default test2'>
                <div class='boxed-answer padding5'>
<!-- UPDATE ANSWER CONTENT -->                        
<form class="answer">
    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
    <input type='hidden' name='test_id' value='<%= @currentTest.id %>'>
    <input type='hidden' name='question_id' value='<%= question.id %>'>
    <input type='hidden' name='answer_id' value='<%= answer.id %>'> 
    <% if answer.correct %>
        <input type='checkbox' name='correctAnswer' class='correct-answer' checked />
    <% else %>
        <input type='checkbox' name='correctAnswer' class='correct-answer'>
    <% end %>
    <input type='text' class='answer' name='answer' value='<%= answer.answer %>'>
</form>
<!-- DELETE ANSWER -->
<form class="delete-answer">
    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
    <input type='hidden' name='test_id' value='<%= @currentTest.id %>'>
    <input type='hidden' name='question_id' value='<%= question.id %>'>
    <input type='hidden' name='answer_id' value='<%= answer.id %>'>
    <input type='submit' value='DELETE' class='btn btn-danger btn-xs added-answer'>
</form>
                </div>
            </li>
        <% end %>
    </ol>

<form class='add-answer'>
    <input type='hidden' name='question_id' value='<%= question.id %>'>
    <input type='submit' class='btn btn-success wide40' value="Add an Answer">
</form>
</div>
                        </div>
                        <div class='col-xs-6'>
                            <div class='row'>
                                <div class='options'>
                                    <div class='row padding15'>
                                        <h4>Set the test options.</h4>
                                        <div class='top'>
                                            <div class='col-xs-6 padded'>
                                                <label>Enter Time Limit:</label><br>
                                            </div>
                                            <div class='col-xs-6 padded'>
<form class='timelimit'>
    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
    <input type='hidden' name='question_id' value='<%= question.id %>'>
    <input type='number' name='timelimit' class='timelimit' value="<%= question.timelimit %>" placeholder='00:00'>
</form>
                                                <br>
                                            </div>
                                        </div>
                                    </div>
                                    <div class='row padding15'>
                                        <div class='bottom padded'>
<!-- DELETE QUESTION -->
<form class='deleteQuestion' method='post' action='/deleteQuestion'>
    <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
    <input type='hidden' name='question_id' value='<%= question.id %>'>
    <input type='submit' value="DELETE QUESTION" class='btn btn-danger deleteQuestion_btn'>
</form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </li>
	<% end %>
      
    </ol> <!-- END QUESTIONS SORT -->

    <div class="row">
        <div class="col-xs-offset-2 col-xs-8">
           <div class="formatted-div">
                <!-- ADD QUESTION -->
                <button class="btn btn-success wide40" id="addQuestion">Add New Question</button>
                <button class="btn btn-primary wide40" id="saveQuestions">SAVE</button>
           </div>
        </div>
    </div>

<script type="text/javascript">

// UPDATE ANSWER CONTENT
// UPDATE QUESTION CONTENT
    $(document).on('click', '#saveQuestions', function(){
        $('form.questions').each(function(){
            console.log(this);
            $.post(
                '/saveQuestion',
                $(this).serialize(),
                function(data){
                    console.log(data);
                },
                'json'
            );         
        });
        $('form.answer').each(function(){
            $.post(
                '/updateAnswer',
                $(this).serialize(),
                function(data){
                    console.log(data);
                },
                'json'
            );
        });
        $('form.timelimit').each(function(){
            $.post(
                '/updateAnswerTimeLimit',
                $(this).serialize(),
                function(data){
                    console.log(data);
                },
                'json'
            );
        });
        return false;
    });

// ADD ANSWER 
    $(document).on('submit', 'form.add-answer', function(){
        var that = $(this);
        $.post(
            '/addAnswer',
            $(this).serialize(),
            function(data){
               $(that).parent().children('ol').append(data);                
            },
            'html'
        );        
        return false;
    });

// DELETE ANSWER 
    $(document).on('submit', 'form.delete-answer', function(){
        var that = $(this);
        $.post(
            '/deleteAnswer',
            $(this).serialize(),
            function(data){
                $(that).parent().parent().remove();
            },
            'json'
        );
        return false;
    });

// DELETE QUESTION
    $(document).on('submit', 'form.deleteQuestion', function(){
        var that = this;
        $.post(
            '/deleteQuestion',
            $(this).serialize(),
            function(data){
                $(that).closest('li.ui-state-default').remove();
            },
            'json'
        );
        return false;
    });
        

// ADD QUESTION   
    $(document).on('click', '#addQuestion', function(){
        $.post(
            '/addQuestion',
            function(data){
                $('.sortable2').append(data);  
            },
            'html'
        );
        return false;
    });

</script>


